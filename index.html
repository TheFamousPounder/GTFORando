<!DOCTYPE html>
<html>
<head>
        <!-- title and icon -->
        <Title>GTFO Rando</Title>
        <link rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- css styling -->
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #111;
            color: #eee;
            text-align: center;
        }

        #loadout {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2em;
            margin-top: 3em;
            min-height: 35em;
        }

        .equipment {
            background-color: #1c1c1c;
            padding: 2em;
            border-radius: 10px;
            min-height: 20em;
            max-height: 30em;
            width: 12%;
        }
        
        .equipment img {
            margin-top: 20px;
            margin-bottom:20px;
            border-radius: 8px;
            max-width: 80%;
            min-width: 50%;
            max-height: 70%;
            min-height: 20%;
            justify-content: center;
        }

        .equipment_topdivider {
            height:30%
        }

        .equipment_bottomdivider {
            margin-bottom: 20px;
            height:90%;
        }

        button {
            margin-top: 30px;
            padding: 10px, 20px;
            font-size: 24px;
            background-color: #2a2a2a;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        button:hover {
            background-color: #444;
        }
        select {
            padding: 8px;
            font-size: 16px;
            background-color: #2a2a2a;
            color: white;
            border: none;
            border-radius: 6px;
        }

        #bgv {
        position: fixed;
        z-index: -1;
        left: 0px;
        top: 0px;
        width: 100vw;
        height: 100vh;
        object-fit: cover;
        pointer-events: none;
        opacity: 5%;
        }

        #rundown-image {
            justify-items: center;
            min-width: 20em;
            max-width: 50em;
            min-height: 20em;
        }

        #rundown-screen {
            margin-top: 5em;
        }

        /* This part works now if you uncomment these */
        /* #top {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: #1a1a1a;
        padding: 10px;
        display: flex;
        justify-content: center;
        gap: 20px;
        z-index: 1000;
        } 

        #bottom {
            margin-top: 12vh;
        } */

    </style>
</head>
<body onload="preLoadAllImages()">

    <div id="top">
        <button onclick="showPage('rando')">Randomizer</button>
        <button onclick="showPage('settings')">Settings</button>
    </div>
    <div id="bottom">
        <div id="rando">
        <!-- static text and setting up rando text and images -->
        <h1 style="margin-top:1.2em">GTFO Randomizer</h1>

        <div id="loadout">
        
            <div class="equipment">
                <div class="equipment_topdivider">
                    <h2>Main weapon</h2>
                    <p id="main-name">Not selected</p>
                </div>
                <div class="equipment_bottomdivider">
                    <img id="main-image" src="" alt="Main Weapon Image" width="200">
                </div>
            </div>

            <div class="equipment">
                <div class="equipment_topdivider">
                    <h2>Special weapon</h2>
                    <p id="special-name">Not selected</p>
                </div>
                <div class="equipment_bottomdivider">
                    <img id="special-image" src="" alt="Special Weapon Image" width="200">
                </div>
            </div>
            
            <div class="equipment">
                <div class="equipment_topdivider">
                    <h2>Tool</h2>
                    <p id="tool-name">Not Selected</p>
                </div>
                <div class="equipment_bottomdivider">
                    <img id="tool-image" src="" alt="Tool Image" width="200">
                </div>
            </div>
            
            <div class="equipment">
                <div class="equipment_topdivider">
                    <h2>Melee</h2>
                    <p id="melee-name">Not selected</p>
                </div>
                <div class="equipment_bottomdivider">
                    <img id="melee-image" src="" alt="Melee Image" width="200">
                </div>
            </div>
        </div>
        <br>
        <div style="height:10%">
            <button id="randomize">Randomize Hell</button>
        </div>

        <!-- rundown randomizer text and dropdown menu-->
        <div id="rundown-screen">
            <h1>Rundown Randomizer</h1>

        
            <label for="rundown-select">Rundown</label>
            <br><br>

            <select id="rundown-select">
                <option value="all">All rundowns</option>
                <option value="1">Rundown 1</option>
                <option value="2">Rundown 2</option>
                <option value="3">Rundown 3</option>
                <option value="4">Rundown 4</option>
                <option value="5">Rundown 5</option>
                <option value="6">Rundown 6</option>
                <option value="7">Rundown 7</option>
                <option value="8">Rundown 8</option>
            </select>
            <br><br>

            <button id="rundown-randomize">Randomize Rundown</button>
            <!-- place holder until randomized-->
            <h2 id="rundown-result">Not selected</h2>
            <img id="rundown-image" src="" width="300">
            </div>
        </div>

            <!-- background video -->
        <video autoplay muted loop id="bgv">
            <source src="video/bgvid.mp4">
        </video>
        <div id="settings" style="display:none; margin-top: 80px;">
            <h1>Deselect weapons</h1>

            <h1>Main weapoons</h1>
            <div id="main-weapon-settings"></div>
            <h1>Special Weapons</h1>
            <div id="special-weapon-settings"></div>
            <h1>Tools</h1>
            <div id="tool-settings"></div>
            <h1>Melee</h1>
            <h6>if you really hate sledge or something I guess ?</h6>
            <div id="melee-settings"></div>

            <button onclick="showPage('rando')">Randomizer</button>
        </div>
    </div>
    <script>
        // All equipment names and rundowns with images 
        const mainWeapons = [
            {
            name: "Pistol",
            image: "images/weapons/pistol.png"
            },

            {
            name: "Burst Pistol",
            image: "images/weapons/burstpistol.png"
            },

            {
            name : "HEL Revolver",
            image: "images/weapons/helrevolver.png"
            },

            {
            name: "Machine Pistol",
            image: "images/weapons/machinepistol.png",
            },

            {
            name: "HEL Autopistol",
            image: "images/weapons/helautopistol.png"
            },

            {
            name: "Bullup Rifle",
            image: "images/weapons/bullup.png"
            },

            {
            name: "SMG",
            image: "images/weapons/smg.png"
            },
            
            {
            name: "PDW",
            image: "images/weapons/pdw.png"
            },

            {
            name: "Heavy SMG",
            image: "images/weapons/heavysmg.png"
            },

            {
            name: "Carbine",
            image: "images/weapons/carbine.png"
            },

            {
            name: "DMR",
            image: "images/weapons/dmr.png"
            },

            {
            name: "Double Tap Rifle",
            image: "images/weapons/doubletaprifle.png"
            },

            {
            name: "Assault Rifle",
            image: "images/weapons/assaultrifle.png"
            },

            {
            name: "Burst Rifle",
            image: "images/weapons/burstrifle.png"
            },

            {
            name: "Rifle",
            image: "images/weapons/rifle.png"
            },

            {
            name: "Sawed-off Shotgun",
            image: "images/weapons/sawedoff.png"
            },

            {
            name: "HEL Shotgun",
            image: "images/weapons/helshotgun.png"
            },

            {
            name: "Sluggy Wuggy (Slug Shotgun)",
            image: "images/weapons/sluggy.png"
            }
        ];
        let enableMainWeapons = new Set(mainWeapons.map(w => w.name));
        const specialWeapons = [
            {
            name: "Heavy Assault Rifle",
            image: "images/weapons/heavyassault.png"
            },
            {
            name: "Short Rifle",
            image: "images/weapons/short.png"
            },
            {
            name: "Shotgun",
            image: "images/weapons/shotgun.png"
            },
            {
            name: "Combat Shotgun",
            image: "images/weapons/combatshotgun.png"
            },
            {
            name: "Scattergun",
            image: "images/weapons/scatter.png"
            },
            {
            name: "Choke Mod Shotgun",
            image: "images/weapons/chokemod.png"
            },
            {
            name: "Revolver",
            image: "images/weapons/revolver.png"
            },
            {
            name: "Machine Gun V",
            image: "images/weapons/machinegunv.png"
            },
            {
            name: "Machine Gun XII",
            image: "images/weapons/machinegunxii.png"
            },
            {
            name: "Burst Cannon",
            image: "images/weapons/burstcannon.png"
            },
            {
            name: "HEL Gun",
            image: "images/weapons/helgun.png"
            },
            {
            name: "High Cal Pistol",
            image: "images/weapons/highcal.png"
            },
            {
            name: "Precision Rifle",
            image: "images/weapons/precisionrifle.png"
            },
            {
            name: "Sniper",
            image: "images/weapons/sniper.png"
            },
            {
            name: "HEL Rifle",
            image: "images/weapons/helrifle.png"
            },
        ]
        let enableSpecialWeapons = new Set(specialWeapons.map(w => w.name));
        const tools = [
            {
            name: "Burst Sentry",
            image: "images/weapons/burstsentry.png"
            },
            {
            name: "Shotgun Sentry",
            image: "images/weapons/shotgunsentry.png"
            },
            {
            name: "Sniper Sentry",
            image: "images/weapons/sniper.png"
            },
            {
            name: "HEL Auto Sentry",
            image: "images/weapons/helautosentry.png"
            },
            {
            name: "Bio Tracker",
            image: "images/weapons/bio.png"
            },
            {
            name: "C-Foam Launcher",
            image: "images/weapons/cfoam.png"
            },
            {
            name: "Mine Deployer",
            image: "images/weapons/mine.png"
            }
        ]
        let enableTools = new Set(tools.map(w => w.name));

        const melee = [
            {
            name: "Sledgehammer (Santonian HDH)",
            image: "images/weapons/sledge.png"
            },
            {
            name: "Sledgehammer (Kovac Sledgehammer)",
            image: "images/weapons/sledge.png"
            },
            {
            name: "Sledgehammer (Omneco Maul)",
            image: "images/weapons/sledge.png"
            },
            {
            name: "Sledgehammer (MACO Gavel)",
            image: "images/weapons/sledge.png"
            },
            {
            name: "Sledgehammer (Santonian Mallet)",
            image: "images/weapons/sledge.png"
            },
            {
            name: "Knife (Mastaba Fixed Blade)",
            image: "images/weapons/knife.png"
            },
            {  
            name: "Knife (Wox Compact)",
            image: "images/weapons/knife.png"
            },
            {
            name: "Bat (Kovac Peacekeeper)",
            image: "images/weapons/bat.png"
            },
            {
            name: "Bat (Attroc Titanium)",
            image: "images/weapons/bat.png"
            },
            {
            name: "Spear (MACO Drillhead)",
            image: "images/weapons/spear.png"
            },
            {
            name: "Spear (IsoCo Stinger)",
            image: "images/weapons/spear.png"
            }
        ]
        let enableMelee = new Set(melee.map(w => w.name));

        const rundowns = [
            { code: "R1A1", rundown: 1, image: "images/rundowns/r1a1.png" },
            { code: "R1B1", rundown: 1, image: "images/rundowns/r1b1.png" },
            { code: "R1B2", rundown: 1, image: "images/rundowns/r1b2.png" },
            { code: "R1C1", rundown: 1, image: "images/rundowns/r1c1.png" },
            { code: "R1C2", rundown: 1, image: "images/rundowns/r1c2.png" },
            { code: "R1D1", rundown: 1, image: "images/rundowns/r1d1.png" },
            { code: "R2A1", rundown: 2, image: "images/rundowns/r2a1.png" },
            { code: "R2B1", rundown: 2, image: "images/rundowns/r2b1.png" },
            { code: "R2B2", rundown: 2, image: "images/rundowns/r2b2.png" },
            { code: "R2B3", rundown: 2, image: "images/rundowns/r2b3.png" },
            { code: "R2B4", rundown: 2, image: "images/rundowns/r2b4.png" },
            { code: "R2C1", rundown: 2, image: "images/rundowns/r2c1.png" },
            { code: "R2C2", rundown: 2, image: "images/rundowns/r2c2.png" },
            { code: "R2D1", rundown: 2, image: "images/rundowns/r2d1.png" },
            { code: "R2D2", rundown: 2, image: "images/rundowns/r2d2.png" },
            { code: "R2E1", rundown: 2, image: "images/rundowns/r2e1.png" },
            { code: "R3A1", rundown: 3, image: "images/rundowns/r3a1.png" },
            { code: "R3A2", rundown: 3, image: "images/rundowns/r3a2.png" },
            { code: "R3A3", rundown: 3, image: "images/rundowns/r3a3.png" },
            { code: "R3B1", rundown: 3, image: "images/rundowns/r3b1.png" },
            { code: "R3B2", rundown: 3, image: "images/rundowns/r3b2.png" },
            { code: "R3C1", rundown: 3, image: "images/rundowns/r3c1.png" },
            { code: "R3D1", rundown: 3, image: "images/rundowns/r3d1.png" },
            { code: "R4A1", rundown: 4, image: "images/rundowns/r4a1.png" },
            { code: "R4A2", rundown: 4, image: "images/rundowns/r4a2.png" },
            { code: "R4A3", rundown: 4, image: "images/rundowns/r4a3.png" },
            { code: "R4B1", rundown: 4, image: "images/rundowns/r4b1.png" },
            { code: "R4B2", rundown: 4, image: "images/rundowns/r4b2.png" },
            { code: "R4B3", rundown: 4, image: "images/rundowns/r4b3.png" },
            { code: "R4C1", rundown: 4, image: "images/rundowns/r4c1.png" },
            { code: "R4C2", rundown: 4, image: "images/rundowns/r4c2.png" },
            { code: "R4C3", rundown: 4, image: "images/rundowns/r4c3.png" },
            { code: "R4D1", rundown: 4, image: "images/rundowns/r4d1.png" },
            { code: "R4D2", rundown: 4, image: "images/rundowns/r4d2.png" },
            { code: "R4E1", rundown: 4, image: "images/rundowns/r4e1.png" },
            { code: "R5A1", rundown: 5, image: "images/rundowns/r5a1.png" },
            { code: "R5A2", rundown: 5, image: "images/rundowns/r5a2.png" },
            { code: "R5A3", rundown: 5, image: "images/rundowns/r5a3.png" },
            { code: "R5B1", rundown: 5, image: "images/rundowns/r5b1.png" },
            { code: "R5B2", rundown: 5, image: "images/rundowns/r5b2.png" },
            { code: "R5B3", rundown: 5, image: "images/rundowns/r5b3.png" },
            { code: "R5B4", rundown: 5, image: "images/rundowns/r5b4.png" },
            { code: "R5C1", rundown: 5, image: "images/rundowns/r5c1.png" },
            { code: "R5C2", rundown: 5, image: "images/rundowns/r5c2.png" },
            { code: "R5C3", rundown: 5, image: "images/rundowns/r5c3.png" },
            { code: "R5D1", rundown: 5, image: "images/rundowns/r5d1.png" },
            { code: "R5D2", rundown: 5, image: "images/rundowns/r5d2.png" },
            { code: "R5E1", rundown: 5, image: "images/rundowns/r5e1.png" },
            { code: "R6A1", rundown: 6, image: "images/rundowns/r6a1.png" },
            { code: "R6AX", rundown: 6, image: "images/rundowns/r6ax.png" },
            { code: "R6B1", rundown: 6, image: "images/rundowns/r6b1.png" },
            { code: "R6B2", rundown: 6, image: "images/rundowns/r6b2.png" },
            { code: "R6BX", rundown: 6, image: "images/rundowns/r6bx.png" },
            { code: "R6C1", rundown: 6, image: "images/rundowns/r6c1.png" },
            { code: "R6C2", rundown: 6, image: "images/rundowns/r6c2.png" },
            { code: "R6C3", rundown: 6, image: "images/rundowns/r6c3.png" },
            { code: "R6CX", rundown: 6, image: "images/rundowns/r6cx.png" },
            { code: "R6D1", rundown: 6, image: "images/rundowns/r6d1.png" },
            { code: "R6D2", rundown: 6, image: "images/rundowns/r6d2.png" },
            { code: "R6D3", rundown: 6, image: "images/rundowns/r6d3.png" },
            { code: "R6D4", rundown: 6, image: "images/rundowns/r6d4.png" },
            { code: "R7A1", rundown: 7, image: "images/rundowns/r7a1.png" },
            { code: "R7B1", rundown: 7, image: "images/rundowns/r7b1.png" },
            { code: "R7B2", rundown: 7, image: "images/rundowns/r7b2.png" },
            { code: "R7B3", rundown: 7, image: "images/rundowns/r7b3.png" },
            { code: "R7C1", rundown: 7, image: "images/rundowns/r7c1.png" },
            { code: "R7C2", rundown: 7, image: "images/rundowns/r7c2.png" },
            { code: "R7C3", rundown: 7, image: "images/rundowns/r7c3.png" },
            { code: "R7D1", rundown: 7, image: "images/rundowns/r7d1.png" },
            { code: "R7D2", rundown: 7, image: "images/rundowns/r7d2.png" },
            { code: "R7E1", rundown: 7, image: "images/rundowns/r7e1.png" },
            { code: "R8A1", rundown: 8, image: "images/rundowns/r8a1.png" },
            { code: "R8A2", rundown: 8, image: "images/rundowns/r8a2.png" },
            { code: "R8B1", rundown: 8, image: "images/rundowns/r8b1.png" },
            { code: "R8B2", rundown: 8, image: "images/rundowns/r8b2.png" },
            { code: "R8B3", rundown: 8, image: "images/rundowns/r8b3.png" },
            { code: "R8B4", rundown: 8, image: "images/rundowns/r8b4.png" },
            { code: "R8C1", rundown: 8, image: "images/rundowns/r8c1.png" },
            { code: "R8C2", rundown: 8, image: "images/rundowns/r8c2.png" },
            { code: "R8D1", rundown: 8, image: "images/rundowns/r8d1.png" },
            { code: "R8D2", rundown: 8, image: "images/rundowns/r8d2.png" },
            { code: "R8E1", rundown: 8, image: "images/rundowns/r8e1.png" },
            { code: "R8E2", rundown: 8, image: "images/rundowns/r8e2.png" }
        ]
        // randomizer function
    function Rando(array) {
        const index = Math.floor(Math.random() * array.length);
        return array[index];
    }

    // PreCache images to prevent stuttering
    function preLoadAllImages() {

        // list definition as safety precaution
        let list = [];

        // Fill in entries from existing arrays
        let validEntryList = [mainWeapons, specialWeapons, tools, melee, rundowns]

        // Loop over constants containing data
        for (let i = 0; i < validEntryList.length; i++) {
            for (let j = 0; j < validEntryList[i].length; j++) {

                // Push into list Array if image string exists
                if (validEntryList[i][j].image != undefined) {
                    list.push(validEntryList[i][j].image);
                }

            }
        }

        // Load the images and remove them from memory
        for (let i = 0; i < list.length; i++) {

            let img = new Image();

            // Define load functionality to remove themselves
            img.onload = function() {
                let index = list.indexOf(this);
                if (index  !== -1) {
                    list.splice(index, 1);
                }
            }

            // Set src so they actually load
            img.src = list[i];
        }

        console.log("Images were precached succesfully");
    }

    document.getElementById("randomize").addEventListener("click", function() {
        // Randomizer equipment and sets randomized name and equivalent picture
        const mainChange = mainWeapons.filter(w => 
            enableMainWeapons.has(w.name)
        );
        // check to make sure something is selected, error if nothing is selected
        if (mainChange.length === 0) {
            alert("No Main Weapons selected, dummy. Leave at least one enabled if you don't want to randomize main.")
            return;
        } 
        const main = Rando(mainChange);

        document.getElementById("main-name").textContent = main.name;
        document.getElementById("main-image").src = main.image;

        const specialChange = specialWeapons.filter(w =>
            enableSpecialWeapons.has(w.name)
        );

        if (specialChange.length === 0) {
            alert("No Special Weapons selected, dummy. Leave at least one enabled if you don't want to randomize Special")
            return;
        }
        const spec = Rando(specialChange)

        document.getElementById("special-name").textContent = spec.name;
        document.getElementById("special-image").src = spec.image;

        const toolChange = tools.filter(w =>
            enableTools.has(w.name)
        );
        
        if (toolChange.length === 0) {
            alert("No tool selectedm dummy. Leave at least one enabled if you don't want to randomize tool.")
            return;
        }

        const tool = Rando(toolChange);

        document.getElementById("tool-name").textContent = tool.name;
        document.getElementById("tool-image").src = tool.image;

        const meleeChange = melee.filter(w => 
            enableMelee.has(w.name)
        );

        if (meleeChange.length === 0) {
            alert("No melee selected, dummy. Leave at least one enabled if you don't want to randomize melee.")
            return;
        }

        const maylay = Rando(meleeChange);

        document.getElementById("melee-name").textContent = maylay.name;
        document.getElementById("melee-image").src = maylay.image;  
    });

    document.getElementById("rundown-randomize").addEventListener("click", function() {

    const selected = document.getElementById("rundown-select").value;

    let filtered;

    if (selected === "all") {
        filtered = rundowns;
    } else {
        filtered = rundowns.filter(r => r.rundown == selected);
    }

    const result = Rando(filtered);

    document.getElementById("rundown-result").textContent = result.code;
    document.getElementById("rundown-image").src = result.image;
});

    // setting what page is shown
    function showPage(page) {
        const rando = document.getElementById("rando");
        const settings = document.getElementById("settings");

        if (page === "rando") {
            rando.style.display = "block";
            settings.style.display = "none";
        } else {
            rando.style.display = "none";
            settings.style.display = "block";
        }
    }

    // creating checkboxed and removing and adding from randomization depending on if checked or not

    function createWeaponSettings(array, elementString, set) {
        const container = document.getElementById(elementString);

        array.forEach(weapon => {
            const label = document.createElement("label");
            label.style.display = "block";

            const checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.checked = true;

            checkbox.addEventListener("change", function() {

                if (this.checked) {
                    set.add(weapon.name);
                } else {
                    set.delete(weapon.name);
                }
            });

            label.appendChild(checkbox);
            label.append(" " + weapon.name);

            container.appendChild(label);
        });
    }

    // init each type
    createWeaponSettings(mainWeapons, "main-weapon-settings", enableMainWeapons);
    createWeaponSettings(specialWeapons, "special-weapon-settings", enableSpecialWeapons);
    createWeaponSettings(tools, "tool-settings", enableTools);
    createWeaponSettings(melee, "melee-settings", enableMelee);

    </script>

</body>


</html>


